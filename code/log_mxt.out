GPU num:  1
Whether mix:  True
Mix layers sets:  [7, 9, 12]
#Labeled: 100, Unlabeled 50000, Val 20000, Test 29999
epoch 0, step 0, loss 2.281432867050171, Lx 2.281432867050171, Lu 0.05951536446809769, Lu2 1.5931003093719482
epoch 0, step 1000, loss 1.575131893157959, Lx 1.564929723739624, Lu 0.4080886244773865, Lu2 0.8934950232505798
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 8, 4, 4, 6, 2, 4, 9, 6, 8, 4, 9, 8, 7, 7, 5, 9],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 0, val acc 0.64265, val_loss 1.302031430530548
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 8, 4, 2, 2, 7, 1, 1, 5, 7, 1, 3, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 0, test acc 0.6072535751191707,test loss 1.467403767208182
Epoch:  0
Best acc:
0.64265
Test acc:
[0.6072535751191707]
epoch 1, step 0, loss 0.8519450426101685, Lx 0.8404315710067749, Lu 0.23026923835277557, Lu2 0.34843015670776367
epoch 1, step 1000, loss 0.543018102645874, Lx 0.5318297743797302, Lu 0.14917753636837006, Lu2 0.37634262442588806
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 9, 4, 4, 6, 3, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 9],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 1, val acc 0.65265, val_loss 1.3510176838874817
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 8, 7, 2, 1, 7, 1, 1, 7, 7, 4, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 1, test acc 0.6148871629054302,test loss 1.5581250525207542
Epoch:  1
Best acc:
0.65265
Test acc:
[0.6072535751191707, 0.6148871629054302]
epoch 2, step 0, loss 1.163282036781311, Lx 1.1110256910324097, Lu 0.5225629806518555, Lu2 0.43854475021362305
epoch 2, step 1000, loss 0.5585422515869141, Lx 0.5121026635169983, Lu 0.3715169131755829, Lu2 0.2837313115596771
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 6, 4, 4, 6, 6, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 2, val acc 0.64705, val_loss 1.4640233280181885
Epoch:  2
Best acc:
0.65265
Test acc:
[0.6072535751191707, 0.6148871629054302]
epoch 3, step 0, loss 1.2302570343017578, Lx 1.1599116325378418, Lu 0.46896910667419434, Lu2 0.1535608023405075
epoch 3, step 1000, loss 1.0037949085235596, Lx 0.8744557499885559, Lu 0.739080548286438, Lu2 0.38634204864501953
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 6, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 3, val acc 0.6499, val_loss 1.4152420579910279
Epoch:  3
Best acc:
0.65265
Test acc:
[0.6072535751191707, 0.6148871629054302]
epoch 4, step 0, loss 0.8801038265228271, Lx 0.8588643670082092, Lu 0.10619741678237915, Lu2 0.21710991859436035
epoch 4, step 1000, loss 0.8477591872215271, Lx 0.8089158535003662, Lu 0.17263703048229218, Lu2 0.379264235496521
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 3, 4, 9, 6, 8, 2, 9, 8, 5, 7, 5, 0],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 4, val acc 0.6433, val_loss 1.5054548201560973
Epoch:  4
Best acc:
0.65265
Test acc:
[0.6072535751191707, 0.6148871629054302]
epoch 5, step 0, loss 0.7655154466629028, Lx 0.7119615077972412, Lu 0.21421563625335693, Lu2 0.2867920398712158
epoch 5, step 1000, loss 0.3655964732170105, Lx 0.3500722348690033, Lu 0.05645174905657768, Lu2 0.11213962733745575
Sample some true labeles and predicted labels
tensor([3, 7, 8, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 5, val acc 0.65305, val_loss 1.4954968742370605
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 8, 7, 6, 2, 7, 2, 1, 7, 4, 4, 6, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 5, test acc 0.6193873129104304,test loss 1.704562842434631
Epoch:  5
Best acc:
0.65305
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304]
epoch 6, step 0, loss 0.5408413410186768, Lx 0.4774489998817444, Lu 0.21130788326263428, Lu2 0.5047707557678223
epoch 6, step 1000, loss 0.42139413952827454, Lx 0.3711686134338379, Lu 0.1545400768518448, Lu2 0.21239732205867767
Sample some true labeles and predicted labels
tensor([4, 7, 8, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 6, val acc 0.649, val_loss 1.4845200582504272
Epoch:  6
Best acc:
0.65305
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304]
epoch 7, step 0, loss 0.4801258444786072, Lx 0.45290717482566833, Lu 0.07776765525341034, Lu2 0.12386113405227661
epoch 7, step 1000, loss 0.844738781452179, Lx 0.822165846824646, Lu 0.06019449234008789, Lu2 0.1484224498271942
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 7, val acc 0.6572, val_loss 1.5340769371032714
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 8, 7, 6, 2, 7, 0, 1, 7, 4, 4, 6, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 7, test acc 0.6175539184639488,test loss 1.7871689207653447
Epoch:  7
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 8, step 0, loss 1.6179792881011963, Lx 1.4852299690246582, Lu 0.33187323808670044, Lu2 0.5312212705612183
epoch 8, step 1000, loss 1.3905282020568848, Lx 1.1491622924804688, Lu 0.567919909954071, Lu2 0.23666390776634216
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 3, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 8, val acc 0.64515, val_loss 1.66816092710495
Epoch:  8
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 9, step 0, loss 0.9019082188606262, Lx 0.8272650837898254, Lu 0.16587358713150024, Lu2 0.3175957202911377
epoch 9, step 1000, loss 1.0727543830871582, Lx 1.0278856754302979, Lu 0.09446050971746445, Lu2 0.2777777910232544
Sample some true labeles and predicted labels
tensor([4, 7, 9, 8, 4, 4, 4, 6, 6, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 9, val acc 0.64985, val_loss 1.5775549156188964
Epoch:  9
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 10, step 0, loss 0.9318401217460632, Lx 0.8662378787994385, Lu 0.13120445609092712, Lu2 0.20085667073726654
epoch 10, step 1000, loss 1.1609034538269043, Lx 1.0448025465011597, Lu 0.22114452719688416, Lu2 0.6145069003105164
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 7, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 10, val acc 0.65055, val_loss 1.5678807942390443
Epoch:  10
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 11, step 0, loss 1.202202320098877, Lx 1.1460442543029785, Lu 0.10210567712783813, Lu2 0.25860095024108887
epoch 11, step 1000, loss 1.312798261642456, Lx 1.2388110160827637, Lu 0.12867341935634613, Lu2 0.27693337202072144
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 3, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 11, val acc 0.6318, val_loss 1.7117288014411927
Epoch:  11
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 12, step 0, loss 0.8255491256713867, Lx 0.7160466909408569, Lu 0.1825040876865387, Lu2 0.17519214749336243
epoch 12, step 1000, loss 0.8531306982040405, Lx 0.7241324186325073, Lu 0.20639722049236298, Lu2 0.2060956209897995
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 6, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 12, val acc 0.6565, val_loss 1.6008670413970947
Epoch:  12
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 13, step 0, loss 1.0831164121627808, Lx 0.879479706287384, Lu 0.3132871985435486, Lu2 0.23367266356945038
epoch 13, step 1000, loss 1.11529541015625, Lx 0.8228132128715515, Lu 0.43330690264701843, Lu2 0.352767676115036
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 13, val acc 0.6549, val_loss 1.7217813161849975
Epoch:  13
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 14, step 0, loss 1.229688048362732, Lx 1.0650866031646729, Lu 0.2351449579000473, Lu2 0.2639787793159485
epoch 14, step 1000, loss 0.7907976508140564, Lx 0.72198086977005, Lu 0.09491968154907227, Lu2 0.1332409530878067
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 14, val acc 0.64985, val_loss 1.747023137664795
Epoch:  14
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 15, step 0, loss 0.8263542056083679, Lx 0.7092773914337158, Lu 0.15610240399837494, Lu2 0.44538232684135437
epoch 15, step 1000, loss 0.7666571140289307, Lx 0.7533541321754456, Lu 0.01716514490544796, Lu2 0.05164054036140442
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 15, val acc 0.6511, val_loss 1.835543473625183
Epoch:  15
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 16, step 0, loss 1.2729443311691284, Lx 0.6845921277999878, Lu 0.7354402542114258, Lu2 0.16400903463363647
epoch 16, step 1000, loss 0.4413263201713562, Lx 0.3157200515270233, Lu 0.1522500365972519, Lu2 0.07463029026985168
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 8, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 16, val acc 0.65485, val_loss 1.7237503597259523
Epoch:  16
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 17, step 0, loss 0.9823914766311646, Lx 0.689798891544342, Lu 0.344226598739624, Lu2 0.31095004081726074
epoch 17, step 1000, loss 1.6020100116729736, Lx 1.2297773361206055, Lu 0.4254087805747986, Lu2 0.3534223437309265
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 7, 5, 7],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 17, val acc 0.65635, val_loss 1.7302585266113282
Epoch:  17
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 18, step 0, loss 1.0127735137939453, Lx 0.7231112718582153, Lu 0.3218469023704529, Lu2 0.33246898651123047
epoch 18, step 1000, loss 0.982883095741272, Lx 0.7652989625930786, Lu 0.2352260798215866, Lu2 0.2523479461669922
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 7, 5, 6],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 18, val acc 0.65335, val_loss 1.7377415340423583
Epoch:  18
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
epoch 19, step 0, loss 0.9246255159378052, Lx 0.7143539786338806, Lu 0.22133848071098328, Lu2 0.43373602628707886
epoch 19, step 1000, loss 0.9501814246177673, Lx 0.8684422373771667, Lu 0.08383505046367645, Lu2 0.07983110845088959
Sample some true labeles and predicted labels
tensor([3, 7, 9, 8, 4, 4, 4, 6, 2, 4, 9, 6, 8, 2, 9, 8, 7, 7, 5, 8],
       device='cuda:0')
tensor([3, 7, 9, 8, 4, 4, 4, 6, 7, 4, 3, 9, 8, 2, 9, 0, 7, 8, 5, 8],
       device='cuda:0')
epoch 19, val acc 0.6547, val_loss 1.8704846042633057
Epoch:  19
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
Finished training!
Best acc:
0.6572
Test acc:
[0.6072535751191707, 0.6148871629054302, 0.6193873129104304, 0.6175539184639488]
