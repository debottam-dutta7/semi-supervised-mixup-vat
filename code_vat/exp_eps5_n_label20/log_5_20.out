GPU num:  1
Whether mix:  True
Mix layers sets:  [7, 9, 12]
#Labeled: 200, Unlabeled 50000, Val 20000, Test 29999
GPU num:  1
Whether mix:  True
Mix layers sets:  [7, 9, 12]
#Labeled: 200, Unlabeled 5000, Val 2000, Test 9999
epoch 0, step 0, loss 2.263608932495117, Lx 2.2455573081970215, Lu 0.03780052810907364, Lu2 1.597510576248169
Sample some true labeles and predicted labels
tensor([8, 8, 4, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 1, 8, 8, 8, 8, 8],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 0, val acc 0.136, val_loss 2.2771838150024415
Sample some true labeles and predicted labels
tensor([8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 4, 8, 8, 8, 4, 8, 8, 8, 8, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 0, test acc 0.12481248124812482,test loss 2.298067007509276
Epoch:  0
Best acc:
0.136
Test acc:
GPU num:  1
Whether mix:  True
Mix layers sets:  [7, 9, 12]
#Labeled: 200, Unlabeled 5000, Val 2000, Test 9999
epoch 0, step 0, loss 2.236002206802368, Lx 2.2273497581481934, Lu 0.07586246728897095, Lu2 1.5912675857543945
Sample some true labeles and predicted labels
tensor([1, 5, 1, 1, 5, 5, 1, 1, 1, 1, 1, 5, 1, 5, 1, 5, 5, 1, 2, 5],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 0, val acc 0.1375, val_loss 2.356224073410034
Sample some true labeles and predicted labels
tensor([1, 5, 5, 1, 1, 5, 1, 1, 5, 1, 1, 1, 5, 1, 1, 1, 1, 1, 5, 1],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 0, test acc 0.1259125912591259,test loss 2.40838359432085
Epoch:  0
Best acc:
0.1375
Test acc:
[0.1259125912591259]
epoch 1, step 0, loss 2.2862086296081543, Lx 2.2654876708984375, Lu 0.21447181701660156, Lu2 1.4918407201766968
Sample some true labeles and predicted labels
tensor([1, 3, 1, 1, 3, 6, 4, 1, 8, 1, 1, 6, 1, 7, 1, 3, 5, 2, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 1, val acc 0.285, val_loss 2.06792031955719
Sample some true labeles and predicted labels
tensor([8, 1, 3, 1, 1, 8, 1, 1, 3, 1, 1, 1, 7, 8, 1, 1, 1, 3, 3, 1],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 1, test acc 0.3009300930093009,test loss 2.056597015907531
Epoch:  1
Best acc:
0.285
Test acc:
[0.1259125912591259, 0.3009300930093009]
epoch 2, step 0, loss 1.9682984352111816, Lx 1.8115907907485962, Lu 0.187455952167511, Lu2 1.5153005123138428
Sample some true labeles and predicted labels
tensor([2, 5, 4, 8, 4, 2, 4, 2, 8, 4, 2, 6, 9, 7, 2, 5, 5, 2, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 2, val acc 0.5695, val_loss 1.4714167795181274
Sample some true labeles and predicted labels
tensor([8, 1, 7, 3, 2, 2, 4, 2, 3, 4, 2, 0, 7, 8, 4, 9, 7, 2, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 2, test acc 0.5103510351035103,test loss 1.6131907572018074
Epoch:  2
Best acc:
0.5695
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103]
epoch 3, step 0, loss 2.093903064727783, Lx 1.8158535957336426, Lu 0.2830352187156677, Lu2 1.2897173166275024
Sample some true labeles and predicted labels
tensor([2, 5, 4, 9, 4, 2, 4, 2, 8, 7, 8, 6, 9, 7, 2, 7, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 3, val acc 0.582, val_loss 1.407440920829773
Sample some true labeles and predicted labels
tensor([8, 1, 7, 3, 2, 9, 7, 2, 7, 7, 8, 1, 7, 8, 4, 9, 7, 9, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 3, test acc 0.5200520052005201,test loss 1.5895123426074182
Epoch:  3
Best acc:
0.582
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201]
epoch 4, step 0, loss 1.5823427438735962, Lx 1.3601239919662476, Lu 0.41828617453575134, Lu2 1.1444945335388184
Sample some true labeles and predicted labels
tensor([7, 5, 1, 9, 3, 1, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 4, val acc 0.6515, val_loss 1.199114294052124
Sample some true labeles and predicted labels
tensor([8, 1, 7, 3, 2, 0, 4, 2, 1, 1, 8, 1, 7, 8, 1, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 4, test acc 0.5755575557555755,test loss 1.446559474401229
Epoch:  4
Best acc:
0.6515
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755]
epoch 5, step 0, loss 1.8857556581497192, Lx 1.6874042749404907, Lu 0.4083513915538788, Lu2 1.142857313156128
Sample some true labeles and predicted labels
tensor([2, 5, 2, 9, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 5, val acc 0.642, val_loss 1.2045505247116088
Epoch:  5
Best acc:
0.6515
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755]
epoch 6, step 0, loss 1.8506970405578613, Lx 1.3991341590881348, Lu 0.6196538805961609, Lu2 1.2031086683273315
Sample some true labeles and predicted labels
tensor([7, 5, 2, 9, 4, 2, 4, 2, 8, 6, 0, 9, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 6, val acc 0.626, val_loss 1.2968322496414184
Epoch:  6
Best acc:
0.6515
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755]
epoch 7, step 0, loss 1.796893835067749, Lx 0.7824861407279968, Lu 0.6594709157943726, Lu2 0.8258994817733765
Sample some true labeles and predicted labels
tensor([2, 5, 1, 9, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 7, val acc 0.6535, val_loss 1.1880998649597168
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 9, 4, 2, 1, 3, 0, 1, 7, 6, 1, 9, 7, 3, 1, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 7, test acc 0.5783578357835784,test loss 1.4698149693800289
Epoch:  7
Best acc:
0.6535
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784]
epoch 8, step 0, loss 1.574049949645996, Lx 0.9373700618743896, Lu 0.30917030572891235, Lu2 0.7337939143180847
Sample some true labeles and predicted labels
tensor([2, 5, 1, 9, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 8, val acc 0.653, val_loss 1.1954855089187622
Epoch:  8
Best acc:
0.6535
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784]
epoch 9, step 0, loss 1.7788867950439453, Lx 1.1828620433807373, Lu 0.2468053102493286, Lu2 0.6879462003707886
Sample some true labeles and predicted labels
tensor([7, 5, 1, 9, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 9, val acc 0.655, val_loss 1.1908140830993652
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 9, 7, 2, 1, 1, 0, 1, 7, 4, 1, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 9, test acc 0.5874587458745875,test loss 1.4259163674646311
Epoch:  9
Best acc:
0.655
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875]
epoch 10, step 0, loss 1.8623254299163818, Lx 1.3442915678024292, Lu 0.36720961332321167, Lu2 0.9348129034042358
Sample some true labeles and predicted labels
tensor([2, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 10, val acc 0.6665, val_loss 1.1439005899429322
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 9, 7, 2, 1, 7, 8, 1, 7, 8, 4, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 10, test acc 0.587958795879588,test loss 1.4513392762215522
Epoch:  10
Best acc:
0.6665
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588]
epoch 11, step 0, loss 1.3754298686981201, Lx 1.008192539215088, Lu 0.3760938048362732, Lu2 0.8050506114959717
Sample some true labeles and predicted labels
tensor([2, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 5, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 11, val acc 0.661, val_loss 1.1664179601669311
Epoch:  11
Best acc:
0.6665
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588]
epoch 12, step 0, loss 1.9980956315994263, Lx 1.319079875946045, Lu 0.8188847303390503, Lu2 0.6302922964096069
Sample some true labeles and predicted labels
tensor([7, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 5, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 12, val acc 0.6695, val_loss 1.1543254089355468
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 9, 7, 2, 1, 7, 0, 1, 7, 4, 4, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 12, test acc 0.5916591659165916,test loss 1.4237491334005645
Epoch:  12
Best acc:
0.6695
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916]
epoch 13, step 0, loss 1.4702380895614624, Lx 1.0001916885375977, Lu 0.23903381824493408, Lu2 0.4207603931427002
Sample some true labeles and predicted labels
tensor([2, 5, 1, 9, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 13, val acc 0.6635, val_loss 1.170691367149353
Epoch:  13
Best acc:
0.6695
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916]
epoch 14, step 0, loss 2.1888883113861084, Lx 1.8726353645324707, Lu 0.3842078149318695, Lu2 0.7443783283233643
Sample some true labeles and predicted labels
tensor([2, 5, 2, 5, 4, 1, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 14, val acc 0.6675, val_loss 1.1716158370971679
Epoch:  14
Best acc:
0.6695
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916]
epoch 15, step 0, loss 1.5301878452301025, Lx 1.0843770503997803, Lu 0.5681795477867126, Lu2 0.5621735453605652
Sample some true labeles and predicted labels
tensor([2, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 5, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 15, val acc 0.6655, val_loss 1.2196330671310425
Epoch:  15
Best acc:
0.6695
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916]
epoch 16, step 0, loss 1.700197696685791, Lx 1.2092535495758057, Lu 0.5774937868118286, Lu2 0.21594125032424927
Sample some true labeles and predicted labels
tensor([7, 5, 2, 5, 4, 1, 4, 2, 8, 7, 0, 6, 9, 5, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 16, val acc 0.6785, val_loss 1.148883111000061
Sample some true labeles and predicted labels
tensor([8, 1, 1, 3, 2, 9, 4, 2, 1, 7, 0, 1, 7, 4, 6, 9, 7, 3, 6, 8],
       device='cuda:0')
tensor([8, 1, 3, 3, 2, 2, 4, 2, 3, 7, 1, 1, 7, 8, 6, 9, 7, 3, 9, 8],
       device='cuda:0')
epoch 16, test acc 0.5913591359135913,test loss 1.4839818399302278
Epoch:  16
Best acc:
0.6785
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916, 0.5913591359135913]
epoch 17, step 0, loss 2.449671506881714, Lx 1.7723323106765747, Lu 0.7534197568893433, Lu2 0.6948320269584656
Sample some true labeles and predicted labels
tensor([2, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 17, val acc 0.667, val_loss 1.1741216287612914
Epoch:  17
Best acc:
0.6785
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916, 0.5913591359135913]
epoch 18, step 0, loss 1.2922284603118896, Lx 1.0589640140533447, Lu 0.15257465839385986, Lu2 0.393807053565979
Sample some true labeles and predicted labels
tensor([7, 5, 2, 5, 4, 1, 4, 2, 8, 7, 0, 6, 9, 5, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 18, val acc 0.652, val_loss 1.1933815498352052
Epoch:  18
Best acc:
0.6785
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916, 0.5913591359135913]
epoch 19, step 0, loss 1.0630850791931152, Lx 0.8590723276138306, Lu 0.1738753318786621, Lu2 0.5174508094787598
Sample some true labeles and predicted labels
tensor([7, 5, 2, 5, 4, 2, 4, 2, 8, 7, 0, 6, 9, 7, 2, 5, 5, 9, 8, 2],
       device='cuda:0')
tensor([7, 5, 3, 9, 4, 1, 4, 2, 0, 7, 0, 3, 9, 2, 2, 5, 5, 1, 8, 6],
       device='cuda:0')
epoch 19, val acc 0.663, val_loss 1.2049903688430785
Epoch:  19
Best acc:
0.6785
Test acc:
[0.1259125912591259, 0.3009300930093009, 0.5103510351035103, 0.5200520052005201, 0.5755575557555755, 0.5783578357835784, 0.5874587458745875, 0.587958795879588, 0.5916591659165916, 0.5913591359135913]
Finished training!
Best acc:
0.6785
Test accs:
